!function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("jquery"),require("ko"),exports):"function"==typeof define&&define.amd?define(["jquery","ko","exports"],e):e(jQuery,ko,ko.validate={})}(function(e,a,t){function r(e){var t="max"===e;return function(r,i){if(a.validate.utils.isEmptyVal(r))return!0;var n,s;void 0===i.typeAttr?(s="text",n=i):(s=i.typeAttr,n=i.value),isNaN(n)||n instanceof Date||(s="number");var l,o,u;switch(s.toLowerCase()){case"week":if(l=/^(\d{4})-W(\d{2})$/,o=r.match(l),null===o)throw new Error("Invalid value for "+e+" attribute for week input.  Should look like '2000-W33' http://www.w3.org/TR/html-markup/input.week.html#input.week.attrs.min");return u=n.match(l),u?t?o[1]<u[1]||o[1]===u[1]&&o[2]<=u[2]:o[1]>u[1]||o[1]===u[1]&&o[2]>=u[2]:!1;case"month":if(l=/^(\d{4})-(\d{2})$/,o=r.match(l),null===o)throw new Error("Invalid value for "+e+" attribute for month input.  Should look like '2000-03' http://www.w3.org/TR/html-markup/input.month.html#input.month.attrs.min");return u=n.match(l),u?t?o[1]<u[1]||o[1]===u[1]&&o[2]<=u[2]:o[1]>u[1]||o[1]===u[1]&&o[2]>=u[2]:!1;case"number":case"range":return t?!isNaN(r)&&parseFloat(r)<=parseFloat(n):!isNaN(r)&&parseFloat(r)>=parseFloat(n);default:return t?n>=r:r>=n}}}if("undefined"==typeof a)throw new Error("Knockout is required, please ensure it is loaded before loading this validation plug-in");a.validate=t,a.validate.utils=function(){return{getBindingHandlerValue:function(e,a){return a().hasOwnProperty("value")?a().value:a().hasOwnProperty("textInput")?a().textInput:a().hasOwnProperty("checked")?a().checked:void 0},isArray:function(e){return e.isArray||"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return null!==e&&"object"==typeof e},getValue:function(e){return a.utils.unwrapObservable(e)},hasAttribute:function(e,a){return null!==e.getAttribute(a)},getAttribute:function(e,a){return e.getAttribute(a)},setAttribute:function(e,a,t){return e.setAttribute(a,t)},isNumber:function(e){return!isNaN(e)},isEmptyVal:function(e){return void 0===e?!0:null===e?!0:""===e?!0:void 0},formatMessage:function(e,t,r){var i=a.validate.utils;if(i.isObject(t)&&t.typeAttr&&(t=t.value),"function"==typeof e)return e(t,r);var n=a.unwrap(t);return null==n&&(n=[]),i.isArray(n)||(n=[n]),e.replace(/{(\d+)}/gi,function(e,a){return"undefined"!=typeof n[a]?n[a]:e})}}}();var i={useRequiredMarker:!0,classElementError:"error",classMessageError:"error-message",classHasRequired:"has-required",classHasError:"has-error",classGroupContainer:"form-group",appendMessageToContainer:!1},n=(a.validate,a.utils.extend({},i));a.validate.utils.resetConfig=function(){a.utils.extend(n,i)},a.validate.configuration=n,a.validate.rules={},a.validate.rules.required={validator:function(e,a){var t;return void 0===e||null===e?!a:(t=e,"string"==typeof e&&(t=String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")),a?(t+"").length>0:!0)},message:"Obrigatório"},a.validate.rules.min={validator:r("min"),message:"Insira um valor maior ou igual a {0}."},a.validate.rules.max={validator:r("max"),message:"Insira um valor menor ou igual a {0}."},a.validate.rules.email={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e):!0},message:"Endereço de e-mail inválido"},a.validate.rules.cpf={message:"CPF inválido.",validator:function(e,t){if(a.validate.utils.isEmptyVal(e))return!0;var r,i,n,s,l,o;if(e=e.replace(/(\.)|(\-)|(\/)/g,""),o=1,e.length<11)return!1;for(s=0;s<e.length-1;s++)if(e.charAt(s)!=e.charAt(s+1)){o=0;break}if(o)return!1;for(r=e.substring(0,9),i=e.substring(9),n=0,s=10;s>1;s--)n+=r.charAt(10-s)*s;if(l=2>n%11?0:11-n%11,l!=i.charAt(0))return!1;for(r=e.substring(0,10),n=0,s=11;s>1;s--)n+=r.charAt(11-s)*s;return l=2>n%11?0:11-n%11,l!=i.charAt(1)?!1:!0}},a.validate.rules.cnpj={message:"CNPJ inválido.",validator:function(e,t){if(a.validate.utils.isEmptyVal(e))return!0;var r,i,n,s,l,o,u,d;if(e=e.replace(/(\.)|(\-)|(\/)/g,""),d=1,e.length<14&&e.length<15)return!1;for(s=0;s<e.length-1;s++)if(e.charAt(s)!=e.charAt(s+1)){d=0;break}if(d)return!1;for(u=e.length-2,r=e.substring(0,u),i=e.substring(u),n=0,o=u-7,s=u;s>=1;s--)n+=r.charAt(u-s)*o--,2>o&&(o=9);if(l=2>n%11?0:11-n%11,l!=i.charAt(0))return!1;for(u+=1,r=e.substring(0,u),n=0,o=u-7,s=u;s>=1;s--)n+=r.charAt(u-s)*o--,2>o&&(o=9);return l=2>n%11?0:11-n%11,l!=i.charAt(1)?!1:!0}},a.validate.rules.validarUsuario={valid:!1,message:"Nome de usuário já existe, escolha outro nome.",validator:function(t,r){return a.validate.utils.isEmptyVal(t)?!0:void a.computed(function(){e.ajax({url:"/Seguranca/Usuario/ValidarDuplicado",data:{login:a.utils.unwrapObservable(t),idPessoa:a.utils.unwrapObservable(r)},async:!1}).success(function(e){a.validate.rules.validarUsuario.valid=e.Sucesso})})}},a.validate.rules.inscricaoEstadual={message:"Inscrição Estadual inválida.",validator:function(e,t){return t?a.validate.utils.isEmptyVal(value)?!0:void 0:!0}},a.validate.rules.date={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)||t&&!/Invalid|NaN/.test(new Date(e)):!0},message:"Data inválida"},a.validate.rules.dateISO={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)||t&&/^\d{4}[-/](?:0?[1-9]|1[012])[-/](?:0?[1-9]|[12][0-9]|3[01])$/.test(e):!0},message:"Data inválida"},a.validate.rules.number={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e):!0},message:"Insira somente números"},a.validate.rules.digit={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)||t&&/^\d+$/.test(e):!0},message:"Insira somente dígitos"},a.validate.rules.cep={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)?!0:(e=e.replace(/\D/g,""),8===e.length):!0},message:"CEP inválido"},a.validate.rules.minLength={validator:function(e,t){if(a.validate.utils.isEmptyVal(e))return!0;var r=a.validate.utils.isNumber(e)?""+e:e;return r.length>=t},message:"Insira pelo menos {0} caracter(es)"},a.validate.rules.maxLength={validator:function(e,t){if(a.validate.utils.isEmptyVal(e))return!0;var r=a.validate.utils.isNumber(e)?""+e:e;return r.length<=t},message:"Insira no máximo {0} caracter(es)"},a.validate.rules.pattern={validator:function(e,t){return a.validate.utils.isEmptyVal(e)||null!==e.toString().match(t)},message:"Valor inválido"},a.validate.rules.phone={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)?!0:(e=e.replace(/\D/g,""),11===e.length||10===e.length):!0},message:"Telefone inválido"},a.validate.rules.phoneUS={validator:function(e,t){return t?a.validate.utils.isEmptyVal(e)?!0:"string"!=typeof e?!1:(e=e.replace(/\s+/g,""),t&&e.length>9&&e.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Telefone inválido"},a.validate.rules.equal={validator:function(e,t){var r=t;return a.validate.utils.isEmptyVal(e)&&a.validate.utils.isEmptyVal(r)?!0:e===a.validate.utils.getValue(r)},message:"Valores devem ser iguais"},a.validate.rules.notEqual={validator:function(e,t){var r=t;return a.validate.utils.isEmptyVal(e)&&a.validate.utils.isEmptyVal(r)?!0:e!==a.validate.utils.getValue(r)},message:"Valores não podem ser iguais"},a.validate.setValidationProperties=function(t){var r=function(){var t=this;this.invalidFields=a.observableArray([]),this.isValid=a.computed(function(){return 0===t.invalidFields().length}),this.isValidShowErrors=function(){return t.isValid()?!0:(t.showErrors(!0),!1)},this.showErrors=function(r){void 0===r&&(r=!0),a.utils.arrayForEach(t.invalidFields(),function(a,t){var r=e("#"+a),i=r.data("options"),n=r.closest("."+i.classGroupContainer).addClass(i.classHasError);r.addClass(i.classElementError),i.appendMessageToContainer?n.find("."+i.classMessageError).show():r.next().show(),0===t&&(r.is(":visible")?r.focus():n[0].scrollIntoView({behavior:"smooth"}))})}};a.utils.extend(t,new r)},a.bindingHandlers.validateOptions=function(){return{init:function(e,t,r,i,n){var s=a.utils.unwrapObservable(t()),l=n.extend({validateOptions:s});return a.applyBindingsToDescendants(l,e),{controlsDescendantBindings:!0}}}}(),a.bindingHandlers.validate={init:function(t,r,i,n,s){var l=a.validate.utils.getBindingHandlerValue(r,i),n=s.$component?s.$component:n,o=s.hasOwnProperty("validateOptions")?e.extend(!0,a.validate.configuration,s.validateOptions):a.validate.configuration,t=e(t),u=function(e){n.invalidFields.remove(e)},d=function(e){e.closest("."+o.classGroupContainer).addClass(o.classHasRequired)},v=function(e){e.closest("."+o.classGroupContainer).removeClass(o.classHasRequired)},c=function(e,a){o.appendMessageToContainer?e.closest("."+o.classGroupContainer).find("."+o.classMessageError).text(a):e.next().text(a)},p=function(e){n.invalidFields.push(e)},f=function(e){var a=e.closest("."+o.classGroupContainer);a.removeClass(o.classHasError),e.removeClass(o.classElementError),o.appendMessageToContainer?a.find("."+o.classMessageError).hide():e.next().hide()},m=function(e,a){var t=e.closest("."+o.classGroupContainer);t.addClass(o.classHasError),e.addClass(o.classElementError),o.appendMessageToContainer?t.find("."+o.classMessageError).show():e.next().show()},F=function(e,t){var r=!0,i=[],n="",s=!1,l=null;e.hasOwnProperty("rules")&&(e=e.rules);for(var o in e)if("value"!==o&&"options"!==o)if(a.validate.rules[o]){var u=a.validate.rules[o],n=e[o],d=u.validator(t,a.utils.unwrapObservable(n));"required"===o&&(s=n),u.hasOwnProperty("valid")&&(d=u.valid),d||(l=null!==e[o]&&e[o].hasOwnProperty("message")?e[o].message:u.message,i.push(a.validate.utils.formatMessage(l,n)),r=!1)}else console&&console.error('ValidateWarning: The rule "'+o+'" is not defined, check the rules defined ->',a.validate.rules);return{messages:i,valid:r,hasRequiredRule:s}};return void 0===l?void(console&&console.error('ValidateError: Missing "value" bind parameter. Should be a "value", "textInput", "checked" or a "value" parameter inside the validate handler (validate: { value: observable, required: true })',t)):(r().hasOwnProperty("options")&&(o=e.extend(!0,o,r().options)),o.appendMessageToContainer?e('<span class="'+o.classMessageError+'" style="display: none"></span>').appendTo(t.closest("."+o.classGroupContainer)):e('<span class="'+o.classMessageError+'" style="display: none"></span>').insertAfter(t),t.data("options",o),o.hasOwnProperty("appendErrorsToRoot")?o.appendErrorsToRoot&&(n=s.$root):o.hasOwnProperty("appendErrorsToContext")&&(n=s[o.appendErrorsToContext]),n.hasOwnProperty("isValid")||a.validate.setValidationProperties(n,o),void a.computed(function(){var e=a.utils.unwrapObservable(l),i=a.computedContext.isInitial(),n={},s=t.attr("id");if(0===s.length)throw console&&console.error(t),"ValidateError: Element to validate must have an ID";n=F(r(),e),c(t,n.messages.join(". ")),n.hasRequiredRule?d(t):v(t),n.valid?(u(s),f(t)):(p(s),i||n.hasRequiredRule||m(t))}))},update:function(e,a,t,r,i){}},a.bindingHandlers.validateForm={init:function(a,t,r,i,n){if("FORM"!==a.nodeName)throw"ValidateError: This validateForm handler should be used on a form element";var s=t();if(a.setAttribute("novalidate","novalidate"),$el=e(a),s.hasOwnProperty("submitHandler")){var l=function(){i.isValid()?s.submitHandler():i.showErrors()};$el.on("keydown",function(e){if(console.log(e.target.tagName),13===e.keyCode&&"TEXTAREA"!=e.target.tagName&&!e.target.classList.contains("note-editable")){if(e.target.classList.contains("modal"))return;e.target.blur(),l(),e.stopPropagation(),e.preventDefault()}}),$el.on("submit",function(e){document.activeElement.blur(),e.stopPropagation(),e.preventDefault(),l()})}}},a.applyBindingsWithValidation=function(e,t,r){a.validate.setValidationProperties(e,r),a.applyBindings(e,t)};var s,l={};a.validate.defineLocale=function(e,a){return e&&a?(l[e.toLowerCase()]=a,a):null},a.validate.locale=function(e){if(e){if(e=e.toLowerCase(),!l.hasOwnProperty(e))throw new Error("Localization "+e+" has not been loaded.");a.validate.localize(l[e]),s=e}return s},a.validate.localize=function(e){var t=a.validate.rules;for(var r in e)t.hasOwnProperty(r)&&(t[r].message=e[r])},function(){var e={},t=a.validate.rules;for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r].message);a.validate.defineLocale("pt-br",e)}(),s="pt-br"});